/*!
 * froala_editor v2.6.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */
;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c)}:a(window.jQuery)}(function(a){if(a.extend(a.FE.DEFAULTS,{imageManagerLoadURL:"https://i.froala.com/load-files",imageManagerLoadMethod:"get",imageManagerLoadParams:{},imageManagerPreloader:"",imageManagerDeleteURL:"",imageManagerDeleteMethod:"post",imageManagerDeleteParams:{},imageManagerPageSize:12,imageManagerScrollOffset:20,imageManagerToggleTags:!0}),a.FE.PLUGINS.imageManager=function(G){function H(){if(!s){var W='<div class="fr-modal-head-line"><i class="fa fa-bars fr-modal-more fr-not-available" id="fr-modal-more-'+G.sid+'" title="'+G.language.translate("Tags")+'"></i><h4 data-text="true">'+G.language.translate("Manage Images")+"</h4></div>";W+='<div class="fr-modal-tags" id="fr-modal-tags"></div>';var U='<img class="fr-preloader" id="fr-preloader" alt="'+G.language.translate("Loading")+'.." src="'+G.opts.imageManagerPreloader+'" style="display: none;">';U+='<div class="fr-image-list" id="fr-image-list"></div>';var V=G.modals.create(D,W,U);s=V.$modal,t=V.$head,u=V.$body}s.data("current-image",G.image.get()),G.modals.show(D),v||q(),L()}function I(){G.modals.hide(D)}function J(){var U=a(window).outerWidth();return U<768?2:U<1200?3:4}function K(){w.empty();for(var U=0;U<C;U++){w.append('<div class="fr-list-column"></div>')}}function L(){v.show(),w.find(".fr-list-column").empty(),G.opts.imageManagerLoadURL?a.ajax({url:G.opts.imageManagerLoadURL,method:G.opts.imageManagerLoadMethod,data:G.opts.imageManagerLoadParams,dataType:"json",crossDomain:G.opts.requestWithCORS,xhrFields:{withCredentials:G.opts.requestWithCredentials},headers:G.opts.requestHeaders}).done(function(W,U,V){G.events.trigger("imageManager.imagesLoaded",[W]),M(W,V.response),v.hide()}).fail(function(){var U=this.xhr();l(F,U.response||U.responseText)}):l(b)}function M(V,W){try{w.find(".fr-list-column").empty(),z=0,A=0,B=0,y=V,N()}catch(U){l(c,W)}}function N(){if(A<y.length&&(w.outerHeight()<=u.outerHeight()+G.opts.imageManagerScrollOffset||u.scrollTop()+G.opts.imageManagerScrollOffset>w.outerHeight()-u.outerHeight())){z++;for(var U=G.opts.imageManagerPageSize*(z-1);U<Math.min(y.length,G.opts.imageManagerPageSize*z);U++){O(y[U])}}}function O(U){var V=new Image,W=a('<div class="fr-image-container fr-empty fr-image-'+B+++'" data-loading="'+G.language.translate("Loading")+'.." data-deleting="'+G.language.translate("Deleting")+'..">');S(!1),V.onload=function(){W.height(Math.floor(W.width()/V.width*V.height));var X=a("<img/>");if(U.thumb){X.attr("src",U.thumb)}else{if(l(e,U),!U.url){return l(g,U),!1}X.attr("src",U.url)}if(U.url&&X.attr("data-url",U.url),U.tag){if(t.find(".fr-modal-more.fr-not-available").removeClass("fr-not-available"),t.find(".fr-modal-tags").show(),U.tag.indexOf(",")>=0){for(var Y=U.tag.split(","),Z=0;Z<Y.length;Z++){Y[Z]=Y[Z].trim(),0===x.find('a[title="'+Y[Z]+'"]').length&&x.append('<a role="button" title="'+Y[Z]+'">'+Y[Z]+"</a>")}X.attr("data-tag",Y.join())}else{0===x.find('a[title="'+U.tag.trim()+'"]').length&&x.append('<a role="button" title="'+U.tag.trim()+'">'+U.tag.trim()+"</a>"),X.attr("data-tag",U.tag.trim())}}U.name&&X.attr("alt",U.name);for(var aa in U){U.hasOwnProperty(aa)&&"thumb"!=aa&&"url"!=aa&&"tag"!=aa&&X.attr("data-"+aa,U[aa])}W.append(X).append(a(G.icon.create("imageManagerDelete")).addClass("fr-delete-img").attr("title",G.language.translate("Delete"))).append(a(G.icon.create("imageManagerInsert")).addClass("fr-insert-img").attr("title",G.language.translate("Insert"))),x.find(".fr-selected-tag").each(function(ab,ac){p(X,ac.text)||W.hide()}),X.on("load",function(){W.removeClass("fr-empty"),W.height("auto"),A++,R(Q(parseInt(X.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1)),S(!1),A%G.opts.imageManagerPageSize==0&&N()}),G.events.trigger("imageManager.imageLoaded",[X])},V.onerror=function(){A++,W.remove(),R(Q(parseInt(W.attr("class").match(/fr-image-(\d+)/)[1],10)+1)),l(E,U),A%G.opts.imageManagerPageSize==0&&N()},V.src=U.thumb||U.url,P().append(W)}function P(){var V,U;return w.find(".fr-list-column").each(function(W,X){var Y=a(X);0===W?(U=Y.outerHeight(),V=Y):Y.outerHeight()<U&&(U=Y.outerHeight(),V=Y)}),V}function Q(X){void 0===X&&(X=0);for(var U=[],V=B-1;V>=X;V--){var W=w.find(".fr-image-"+V);W.length&&(U.push(W),a('<div id="fr-image-hidden-container">').append(W),w.find(".fr-image-"+V).remove())}return U}function R(U){for(var V=U.length-1;V>=0;V--){P().append(U[V])}}function S(W){if(void 0===W&&(W=!0),!s.is(":visible")){return !0}var U=J();if(U!=C){C=U;var V=Q();K(),R(V)}G.modals.resize(D),W&&N()}function d(W){var X={},U=W.data();for(var V in U){U.hasOwnProperty(V)&&"url"!=V&&"tag"!=V&&(X[V]=U[V])}return X}function f(Y){var Z=a(Y.currentTarget).siblings("img"),aa=s.data("instance")||G,U=s.data("current-image");if(G.modals.hide(D),aa.image.showProgressBar(),U){U.data("fr-old-src",U.attr("src")),U.trigger("click")}else{aa.events.focus(!0),aa.selection.restore();var V=aa.position.getBoundingRect(),W=V.left+V.width/2+a(G.doc).scrollLeft(),X=V.top+V.height+a(G.doc).scrollTop();aa.popups.setContainer("image.insert",G.$sc),aa.popups.show("image.insert",W,X)}aa.image.insert(Z.data("url"),!1,d(Z),U)}function h(){s.find("#fr-modal-tags > a").each(function(){0===s.find('#fr-image-list [data-tag*="'+a(this).text()+'"]').length&&a(this).removeClass("fr-selected-tag").hide()}),n()}function j(U){var V=a(U.currentTarget).siblings("img"),W=G.language.translate("Are you sure? Image will be deleted.");confirm(W)&&(G.opts.imageManagerDeleteURL?!1!==G.events.trigger("imageManager.beforeDeleteImage",[V])&&(V.parent().addClass("fr-image-deleting"),a.ajax({method:G.opts.imageManagerDeleteMethod,url:G.opts.imageManagerDeleteURL,data:a.extend(a.extend({src:V.attr("src")},d(V)),G.opts.imageManagerDeleteParams),crossDomain:G.opts.requestWithCORS,xhrFields:{withCredentials:G.opts.requestWithCredentials},headers:G.opts.requestHeaders}).done(function(Y){G.events.trigger("imageManager.imageDeleted",[Y]);var X=Q(parseInt(V.parent().attr("class").match(/fr-image-(\d+)/)[1],10)+1);V.parent().remove(),R(X),h(),S(!0)}).fail(function(){var X=this.xhr();l(i,X.response||X.responseText)})):l(k))}function l(U,V){10<=U&&U<20?v.hide():20<=U&&U<30&&a(".fr-image-deleting").removeClass("fr-image-deleting"),G.events.trigger("imageManager.error",[{code:U,message:T[U]},V])}function m(){var U=t.find(".fr-modal-head-line").outerHeight(),V=x.outerHeight();t.toggleClass("fr-show-tags"),t.hasClass("fr-show-tags")?(t.css("height",U+V),x.find("a").css("opacity",1)):(t.css("height",U),x.find("a").css("opacity",0))}function n(){var U=x.find(".fr-selected-tag");U.length>0?(w.find("img").parent().show(),U.each(function(W,V){w.find("img").each(function(Z,X){var Y=a(X);p(Y,V.text)||Y.parent().hide()})})):w.find("img").parent().show(),R(Q()),N()}function o(U){U.preventDefault();var V=a(U.currentTarget);V.toggleClass("fr-selected-tag"),G.opts.imageManagerToggleTags&&V.siblings("a").removeClass("fr-selected-tag"),n()}function p(W,X){for(var U=(W.attr("data-tag")||"").split(","),V=0;V<U.length;V++){if(U[V]==X){return !0}}return !1}function q(){v=s.find("#fr-preloader"),w=s.find("#fr-image-list"),x=s.find("#fr-modal-tags"),C=J(),K(),t.css("height",t.find(".fr-modal-head-line").outerHeight()),G.events.$on(a(G.o_win),"resize",function(){S(y?!0:!1)}),G.helpers.isMobile()&&(G.events.bindClick(w,"div.fr-image-container",function(U){s.find(".fr-mobile-selected").removeClass("fr-mobile-selected"),a(U.currentTarget).addClass("fr-mobile-selected")}),s.on(G._mousedown,function(){s.find(".fr-mobile-selected").removeClass("fr-mobile-selected")})),G.events.bindClick(w,".fr-insert-img",f),G.events.bindClick(w,".fr-delete-img",j),s.on(G._mousedown+" "+G._mouseup,function(U){U.stopPropagation()}),s.on(G._mousedown,"*",function(){G.events.disableBlur()}),u.on("scroll",N),G.events.bindClick(s,"i#fr-modal-more-"+G.sid,m),G.events.bindClick(x,"a",o)}function r(){if(!G.$wp&&"IMG"!=G.el.tagName){return !1}}var s,t,u,v,w,x,y,z,A,B,C,D="image_manager",E=10,F=11,b=12,c=13,e=14,g=15,i=21,k=22,T={};return T[E]="Image cannot be loaded from the passed link.",T[F]="Error during load images request.",T[b]="Missing imageManagerLoadURL option.",T[c]="Parsing load response failed.",T[e]="Missing image thumb.",T[g]="Missing image URL.",T[i]="Error during delete image request.",T[k]="Missing imageManagerDeleteURL option.",{require:["image"],_init:r,show:H,hide:I}},!a.FE.PLUGINS.image){throw new Error("Image manager plugin requires image plugin.")}a.FE.DEFAULTS.imageInsertButtons.push("imageManager"),a.FE.RegisterCommand("imageManager",{title:"Browse",undo:!1,focus:!1,modal:!0,callback:function(){this.imageManager.show()},plugin:"imageManager"}),a.FE.DefineIcon("imageManager",{NAME:"folder"}),a.FE.DefineIcon("imageManagerInsert",{NAME:"plus"}),a.FE.DefineIcon("imageManagerDelete",{NAME:"trash"})});