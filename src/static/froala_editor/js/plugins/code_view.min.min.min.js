/*!
 * froala_editor v2.6.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */
;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c)}:a(window.jQuery)}(function(a){a.extend(a.FE.DEFAULTS,{codeMirror:window.CodeMirror,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"\t",indent_size:1,wrap_line_length:0},codeViewKeepActiveButtons:["fullscreen"]}),a.FE.PLUGINS.codeView=function(h){function i(){return h.$box.hasClass("fr-code-view")}function j(){return f?f.getValue():e.val()}function k(o){var n=j();h.html.set(n),h.$el.blur(),h.$tb.find(" > .fr-command").not(o).removeClass("fr-disabled").attr("aria-disabled",!1),o.removeClass("fr-active").attr("aria-pressed",!1),h.events.focus(!0),h.placeholder.refresh(),h.undo.saveStep()}function l(o){e||(c(),!f&&h.opts.codeMirror?f=h.opts.codeMirror.fromTextArea(e.get(0),h.opts.codeMirrorOptions):h.events.$on(e,"keydown keyup change input",function(){h.opts.height?this.removeAttribute("rows"):(this.rows=1,0===this.value.length?this.style.height="auto":this.style.height=this.scrollHeight+"px")})),h.undo.saveStep(),h.html.cleanEmptyTags(),h.html.cleanWhiteTags(!0),h.core.hasFocus()&&(h.core.isEmpty()||(h.selection.save(),h.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F</span>'),h.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F</span>')));var s=h.html.get(!1,!0);h.$el.find("span.fr-tmp").remove(),h.$box.toggleClass("fr-code-view",!0),h.core.hasFocus()&&h.$el.blur(),s=s.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM"),s=s.replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM"),h.codeBeautifier&&(s=h.codeBeautifier.run(s,h.opts.codeBeautifierOptions));var t,n;if(f){t=s.indexOf("FROALA-SM"),n=s.indexOf("FROALA-EM"),t>n?t=n:n-=9,s=s.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"");var p=s.substring(0,t).length-s.substring(0,t).replace(/\n/g,"").length,q=s.substring(0,n).length-s.substring(0,n).replace(/\n/g,"").length;t=s.substring(0,t).length-s.substring(0,s.substring(0,t).lastIndexOf("\n")+1).length,n=s.substring(0,n).length-s.substring(0,s.substring(0,n).lastIndexOf("\n")+1).length,f.setSize(null,h.opts.height?h.opts.height:"auto"),h.opts.heightMin&&h.$box.find(".CodeMirror-scroll").css("min-height",h.opts.heightMin),f.setValue(s),f.focus(),f.setSelection({line:p,ch:t},{line:q,ch:n}),f.refresh(),f.clearHistory()}else{t=s.indexOf("FROALA-SM"),n=s.indexOf("FROALA-EM")-9,h.opts.heightMin&&e.css("min-height",h.opts.heightMin),h.opts.height&&e.css("height",h.opts.height),h.opts.heightMax&&e.css("max-height",h.opts.height||h.opts.heightMax),e.val(s.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change");var r=a(h.o_doc).scrollTop();e.focus(),e.get(0).setSelectionRange(t,n),a(h.o_doc).scrollTop(r)}h.$tb.find(" > .fr-command").not(o).filter(function(){return h.opts.codeViewKeepActiveButtons.indexOf(a(this).data("cmd"))<0}).addClass("fr-disabled").attr("aria-disabled",!0),o.addClass("fr-active").attr("aria-pressed",!0),!h.helpers.isMobile()&&h.opts.toolbarInline&&h.toolbar.hide()}function m(o){void 0===o&&(o=!i());var n=h.$tb.find('.fr-command[data-cmd="html"]');o?(h.popups.hideAll(),l(n)):(h.$box.toggleClass("fr-code-view",!1),k(n))}function b(){i()&&m(!1),f&&f.toTextArea(),e.val("").removeData().remove(),e=null,g&&(g.remove(),g=null)}function c(){e=a('<textarea class="fr-code" tabIndex="-1">'),h.$wp.append(e),e.attr("dir",h.opts.direction),h.$box.hasClass("fr-basic")||(g=a('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(h.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabIndex="-1"><i class="fa fa-code"></i></button>'),h.$box.append(g),h.events.bindClick(h.$box,"a.html-switch",function(){m(!1)}));var n=function(){return !i()};h.events.on("buttons.refresh",n),h.events.on("copy",n,!0),h.events.on("cut",n,!0),h.events.on("paste",n,!0),h.events.on("destroy",b,!0),h.events.on("html.set",function(){i()&&m(!0)}),h.events.on("form.submit",function(){i()&&(h.html.set(j()),h.events.trigger("contentChanged",[],!0))},!0)}function d(){if(!h.$wp){return !1}}var e,f,g;return{_init:d,toggle:m,isActive:i,get:j}},a.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,toggle:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"}),a.FE.DefineIcon("html",{NAME:"code"})});