/*!
 * froala_editor v2.6.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(a,d){return void 0===d&&(d="undefined"!=typeof window?require("jquery"):require("jquery")(a)),b(d)}:b(window.jQuery)}(function(b){b.extend(b.FE.DEFAULTS,{codeMirror:window.CodeMirror,codeMirrorOptions:{lineNumbers:!0,tabMode:"indent",indentWithTabs:!0,lineWrapping:!0,mode:"text/html",tabSize:2},codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","ol","table","dl"],brace_style:"expand",indent_char:"\t",indent_size:1,wrap_line_length:0},codeViewKeepActiveButtons:["fullscreen"]}),b.FE.PLUGINS.codeView=function(x){function w(){return x.$box.hasClass("fr-code-view")}function v(){return n?n.getValue():o.val()}function u(d){var e=v();x.html.set(e),x.$el.blur(),x.$tb.find(" > .fr-command").not(d).removeClass("fr-disabled").attr("aria-disabled",!1),d.removeClass("fr-active").attr("aria-pressed",!1),x.events.focus(!0),x.placeholder.refresh(),x.undo.saveStep()}function t(A){o||(q(),!n&&x.opts.codeMirror?n=x.opts.codeMirror.fromTextArea(o.get(0),x.opts.codeMirrorOptions):x.events.$on(o,"keydown keyup change input",function(){x.opts.height?this.removeAttribute("rows"):(this.rows=1,0===this.value.length?this.style.height="auto":this.style.height=this.scrollHeight+"px")})),x.undo.saveStep(),x.html.cleanEmptyTags(),x.html.cleanWhiteTags(!0),x.core.hasFocus()&&(x.core.isEmpty()||(x.selection.save(),x.$el.find('.fr-marker[data-type="true"]:first').replaceWith('<span class="fr-tmp fr-sm">F</span>'),x.$el.find('.fr-marker[data-type="false"]:last').replaceWith('<span class="fr-tmp fr-em">F</span>')));var z=x.html.get(!1,!0);x.$el.find("span.fr-tmp").remove(),x.$box.toggleClass("fr-code-view",!0),x.core.hasFocus()&&x.$el.blur(),z=z.replace(/<span class="fr-tmp fr-sm">F<\/span>/,"FROALA-SM"),z=z.replace(/<span class="fr-tmp fr-em">F<\/span>/,"FROALA-EM"),x.codeBeautifier&&(z=x.codeBeautifier.run(z,x.opts.codeBeautifierOptions));var y,m;if(n){y=z.indexOf("FROALA-SM"),m=z.indexOf("FROALA-EM"),y>m?y=m:m-=9,z=z.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"");var l=z.substring(0,y).length-z.substring(0,y).replace(/\n/g,"").length,k=z.substring(0,m).length-z.substring(0,m).replace(/\n/g,"").length;y=z.substring(0,y).length-z.substring(0,z.substring(0,y).lastIndexOf("\n")+1).length,m=z.substring(0,m).length-z.substring(0,z.substring(0,m).lastIndexOf("\n")+1).length,n.setSize(null,x.opts.height?x.opts.height:"auto"),x.opts.heightMin&&x.$box.find(".CodeMirror-scroll").css("min-height",x.opts.heightMin),n.setValue(z),n.focus(),n.setSelection({line:l,ch:y},{line:k,ch:m}),n.refresh(),n.clearHistory()}else{y=z.indexOf("FROALA-SM"),m=z.indexOf("FROALA-EM")-9,x.opts.heightMin&&o.css("min-height",x.opts.heightMin),x.opts.height&&o.css("height",x.opts.height),x.opts.heightMax&&o.css("max-height",x.opts.height||x.opts.heightMax),o.val(z.replace(/FROALA-SM/g,"").replace(/FROALA-EM/g,"")).trigger("change");var i=b(x.o_doc).scrollTop();o.focus(),o.get(0).setSelectionRange(y,m),b(x.o_doc).scrollTop(i)}x.$tb.find(" > .fr-command").not(A).filter(function(){return x.opts.codeViewKeepActiveButtons.indexOf(b(this).data("cmd"))<0}).addClass("fr-disabled").attr("aria-disabled",!0),A.addClass("fr-active").attr("aria-pressed",!0),!x.helpers.isMobile()&&x.opts.toolbarInline&&x.toolbar.hide()}function s(c){void 0===c&&(c=!w());var e=x.$tb.find('.fr-command[data-cmd="html"]');c?(x.popups.hideAll(),t(e)):(x.$box.toggleClass("fr-code-view",!1),u(e))}function r(){w()&&s(!1),n&&n.toTextArea(),o.val("").removeData().remove(),o=null,a&&(a.remove(),a=null)}function q(){o=b('<textarea class="fr-code" tabIndex="-1">'),x.$wp.append(o),o.attr("dir",x.opts.direction),x.$box.hasClass("fr-basic")||(a=b('<a data-cmd="html" title="Code View" class="fr-command fr-btn html-switch'+(x.helpers.isMobile()?"":" fr-desktop")+'" role="button" tabIndex="-1"><i class="fa fa-code"></i></button>'),x.$box.append(a),x.events.bindClick(x.$box,"a.html-switch",function(){s(!1)}));var c=function(){return !w()};x.events.on("buttons.refresh",c),x.events.on("copy",c,!0),x.events.on("cut",c,!0),x.events.on("paste",c,!0),x.events.on("destroy",r,!0),x.events.on("html.set",function(){w()&&s(!0)}),x.events.on("form.submit",function(){w()&&(x.html.set(v()),x.events.trigger("contentChanged",[],!0))},!0)}function p(){if(!x.$wp){return !1}}var o,n,a;return{_init:p,toggle:s,isActive:w,get:v}},b.FE.RegisterCommand("html",{title:"Code View",undo:!1,focus:!1,forcedRefresh:!0,toggle:!0,callback:function(){this.codeView.toggle()},plugin:"codeView"}),b.FE.DefineIcon("html",{NAME:"code"})});