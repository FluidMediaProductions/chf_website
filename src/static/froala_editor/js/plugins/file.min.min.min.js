/*!
 * froala_editor v2.6.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */
;!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(b,c){return void 0===c&&(c="undefined"!=typeof window?require("jquery"):require("jquery")(b)),a(c)}:a(window.jQuery)}(function(a){a.extend(a.FE.POPUP_TEMPLATES,{"file.insert":"[_BUTTONS_][_UPLOAD_LAYER_][_PROGRESS_BAR_]"}),a.extend(a.FE.DEFAULTS,{fileUploadURL:"https://i.froala.com/upload",fileUploadParam:"file",fileUploadParams:{},fileUploadToS3:!1,fileUploadMethod:"POST",fileMaxSize:10485760,fileAllowedTypes:["*"],fileInsertButtons:["fileBack","|"],fileUseSelectedText:!1}),a.FE.PLUGINS.file=function(v){function w(){var J=v.$tb.find('.fr-command[data-cmd="insertFile"]'),G=v.popups.get("file.insert");if(G||(G=l()),y(),!G.hasClass("fr-active")){v.popups.refresh("file.insert"),v.popups.setContainer("file.insert",v.$tb);var H=J.offset().left+J.outerWidth()/2,I=J.offset().top+(v.opts.toolbarBottom?0:J.outerHeight());v.popups.show("file.insert",H,I,J.outerHeight())}}function x(){var G=v.popups.get("file.insert");G||(G=l()),G.find(".fr-layer.fr-active").removeClass("fr-active").addClass("fr-pactive"),G.find(".fr-file-progress-bar-layer").addClass("fr-active"),G.find(".fr-buttons").hide(),z(v.language.translate("Uploading"),0)}function y(H){var G=v.popups.get("file.insert");G&&(G.find(".fr-layer.fr-pactive").addClass("fr-active").removeClass("fr-pactive"),G.find(".fr-file-progress-bar-layer").removeClass("fr-active"),G.find(".fr-buttons").show(),H&&(v.events.focus(),v.popups.hide("file.insert")))}function z(J,G){var H=v.popups.get("file.insert");if(H){var I=H.find(".fr-file-progress-bar-layer");I.find("h3").text(J+(G?" "+G+"%":"")),I.removeClass("fr-error"),G?(I.find("div").removeClass("fr-indeterminate"),I.find("div > span").css("width",G+"%")):I.find("div").addClass("fr-indeterminate")}}function A(J){x();var G=v.popups.get("file.insert"),H=G.find(".fr-file-progress-bar-layer");H.addClass("fr-error");var I=H.find("h3");I.text(J),v.events.disableBlur(),I.focus()}function B(J,G,H){v.edit.on(),v.events.focus(!0),v.selection.restore(),v.opts.fileUseSelectedText&&v.selection.text().length&&(G=v.selection.text()),v.html.insert('<a href="'+J+'" id="fr-inserted-file" class="fr-file">'+G+"</a>");var I=v.$el.find("#fr-inserted-file");I.removeAttr("id"),v.popups.hide("file.insert"),v.undo.saveStep(),t(),v.events.trigger("file.inserted",[I,H])}function C(I){try{if(!1===v.events.trigger("file.uploaded",[I],!0)){return v.edit.on(),!1}var G=JSON.parse(I);return G.link?G:(d(D,I),!1)}catch(H){return d(i,I),!1}}function E(G){try{var H=a(G).find("Location").text(),I=a(G).find("Key").text();return !1===v.events.trigger("file.uploadedToS3",[H,I,G],!0)?(v.edit.on(),!1):H}catch(J){return d(i,G),!1}}function F(I){var K=this.status,L=this.response,M=this.responseXML,N=this.responseText;try{if(v.opts.fileUploadToS3){if(201==K){var G=E(M);G&&B(G,I,L||M)}else{d(i,L||M)}}else{if(K>=200&&K<300){var H=C(N);H&&B(H.link,I,L||N)}else{d(g,L||N)}}}catch(J){d(i,L||N)}}function b(){d(i,this.response||this.responseText||this.responseXML)}function c(H){if(H.lengthComputable){var G=H.loaded/H.total*100|0;z(v.language.translate("Uploading"),G)}}function d(H,G){v.edit.on(),A(v.language.translate("Something went wrong. Please try again.")),v.events.trigger("file.error",[{code:H,message:o[H]},G])}function e(){v.edit.on(),y(!0)}function f(L){if(void 0!==L&&L.length>0){if(!1===v.events.trigger("file.beforeUpload",[L])){return !1}var K=L[0];if(K.size>v.opts.fileMaxSize){return d(k),!1}if(v.opts.fileAllowedTypes.indexOf("*")<0&&v.opts.fileAllowedTypes.indexOf(K.type.replace(/file\//g,""))<0){return d(m),!1}var M;if(v.drag_support.formdata&&(M=v.drag_support.formdata?new FormData:null),M){var G;if(!1!==v.opts.fileUploadToS3){M.append("key",v.opts.fileUploadToS3.keyStart+(new Date).getTime()+"-"+(K.name||"untitled")),M.append("success_action_status","201"),M.append("X-Requested-With","xhr"),M.append("Content-Type",K.type);for(G in v.opts.fileUploadToS3.params){v.opts.fileUploadToS3.params.hasOwnProperty(G)&&M.append(G,v.opts.fileUploadToS3.params[G])}}for(G in v.opts.fileUploadParams){v.opts.fileUploadParams.hasOwnProperty(G)&&M.append(G,v.opts.fileUploadParams[G])}M.append(v.opts.fileUploadParam,K);var H=v.opts.fileUploadURL;v.opts.fileUploadToS3&&(H=v.opts.fileUploadToS3.uploadURL?v.opts.fileUploadToS3.uploadURL:"https://"+v.opts.fileUploadToS3.region+".amazonaws.com/"+v.opts.fileUploadToS3.bucket);var I=v.core.getXHR(H,v.opts.fileUploadMethod);I.onload=function(){F.call(I,K.name)},I.onerror=b,I.upload.onprogress=c,I.onabort=e,x(),v.edit.off();var J=v.popups.get("file.insert");J&&J.off("abortUpload").on("abortUpload",function(){4!=I.readyState&&I.abort()}),I.send(M)}}}function h(G){v.events.$on(G,"dragover dragenter",".fr-file-upload-layer",function(){return a(this).addClass("fr-drop"),!1},!0),v.events.$on(G,"dragleave dragend",".fr-file-upload-layer",function(){return a(this).removeClass("fr-drop"),!1},!0),v.events.$on(G,"drop",".fr-file-upload-layer",function(H){H.preventDefault(),H.stopPropagation(),a(this).removeClass("fr-drop");var I=H.originalEvent.dataTransfer;if(I&&I.files){(G.data("instance")||v).file.upload(I.files)}},!0),v.helpers.isIOS()&&v.events.$on(G,"touchstart",'.fr-file-upload-layer input[type="file"]',function(){a(this).trigger("click")}),v.events.$on(G,"change",'.fr-file-upload-layer input[type="file"]',function(){if(this.files){(G.data("instance")||v).file.upload(this.files)}a(this).val("")},!0)}function j(){y()}function l(L){if(L){return v.popups.onHide("file.insert",j),!0}var G="";G='<div class="fr-buttons">'+v.button.buildList(v.opts.fileInsertButtons)+"</div>";var H="";H='<div class="fr-file-upload-layer fr-layer fr-active" id="fr-file-upload-layer-'+v.id+'"><strong>'+v.language.translate("Drop file")+"</strong><br>("+v.language.translate("or click")+')<div class="fr-form"><input type="file" name="'+v.opts.fileUploadParam+'" accept="/*" tabIndex="-1" aria-labelledby="fr-file-upload-layer-'+v.id+'" role="button"></div></div>';var I='<div class="fr-file-progress-bar-layer fr-layer"><h3 tabIndex="-1" class="fr-message">Uploading</h3><div class="fr-loader"><span class="fr-progress"></span></div><div class="fr-action-buttons"><button type="button" class="fr-command fr-dismiss" data-cmd="fileDismissError" tabIndex="2" role="button">OK</button></div></div>',J={buttons:G,upload_layer:H,progress_bar:I},K=v.popups.create("file.insert",J);return h(K),K}function n(G){v.node.hasClass(G,"fr-file")}function p(G){var H=G.originalEvent.dataTransfer;if(H&&H.files&&H.files.length){var I=H.files[0];if(I&&void 0!==I.type&&I.type.indexOf("image")<0&&(v.opts.fileAllowedTypes.indexOf(I.type)>=0||v.opts.fileAllowedTypes.indexOf("*")>=0)){v.markers.remove(),v.markers.insertAtPoint(G.originalEvent),v.$el.find(".fr-marker").replaceWith(a.FE.MARKERS),v.popups.hideAll();var J=v.popups.get("file.insert");return J||(J=l()),v.popups.setContainer("file.insert",v.$sc),v.popups.show("file.insert",G.originalEvent.pageX,G.originalEvent.pageY),x(),f(H.files),G.preventDefault(),G.stopPropagation(),!1}}}function r(){v.events.on("drop",p),v.events.$on(v.$win,"keydown",function(G){var H=G.which,I=v.popups.get("file.insert");I&&H==a.FE.KEYCODE.ESC&&I.trigger("abortUpload")}),v.events.on("destroy",function(){var G=v.popups.get("file.insert");G&&G.trigger("abortUpload")})}function s(){v.events.disableBlur(),v.selection.restore(),v.events.enableBlur(),v.popups.hide("file.insert"),v.toolbar.showInline()}function t(){var I,G=Array.prototype.slice.call(v.el.querySelectorAll("a.fr-file")),H=[];for(I=0;I<G.length;I++){H.push(G[I].getAttribute("href"))}if(q){for(I=0;I<q.length;I++){H.indexOf(q[I].getAttribute("href"))<0&&v.events.trigger("file.unlink",[q[I]])}}q=G}function u(){r(),v.events.on("link.beforeRemove",n),v.$wp&&(t(),v.events.on("contentChanged",t)),l(!0)}var D=2,g=3,i=4,k=5,m=6,o={};o[1]="File cannot be loaded from the passed link.",o[D]="No link in upload response.",o[g]="Error during file upload.",o[i]="Parsing response failed.",o[k]="File is too large.",o[m]="File file type is invalid.",o[7]="Files can be uploaded only to same domain in IE 8 and IE 9.";var q;return{_init:u,showInsertPopup:w,upload:f,insert:B,back:s,hideProgressBar:y}},a.FE.DefineIcon("insertFile",{NAME:"file-o"}),a.FE.RegisterCommand("insertFile",{title:"Upload File",undo:!1,focus:!0,refreshAfterCallback:!1,popup:!0,callback:function(){this.popups.isVisible("file.insert")?(this.$el.find(".fr-marker").length&&(this.events.disableBlur(),this.selection.restore()),this.popups.hide("file.insert")):this.file.showInsertPopup()},plugin:"file"}),a.FE.DefineIcon("fileBack",{NAME:"arrow-left"}),a.FE.RegisterCommand("fileBack",{title:"Back",undo:!1,focus:!1,back:!0,refreshAfterCallback:!1,callback:function(){this.file.back()},refresh:function(b){this.opts.toolbarInline?(b.removeClass("fr-hidden"),b.next(".fr-separator").removeClass("fr-hidden")):(b.addClass("fr-hidden"),b.next(".fr-separator").addClass("fr-hidden"))}}),a.FE.RegisterCommand("fileDismissError",{title:"OK",callback:function(){this.file.hideProgressBar(!0)}})});