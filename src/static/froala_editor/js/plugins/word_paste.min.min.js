/*!
 * froala_editor v2.6.5 (https://www.froala.com/wysiwyg-editor)
 * License https://froala.com/wysiwyg-editor/terms/
 * Copyright 2014-2017 Froala Labs
 */
;!function(b){"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof module&&module.exports?module.exports=function(a,d){return void 0===d&&(d="undefined"!=typeof window?require("jquery"):require("jquery")(a)),b(d)}:b(window.jQuery)}(function(b){b.extend(b.FE.DEFAULTS,{wordDeniedTags:[],wordDeniedAttrs:[],wordAllowedStyleProps:["font-family","font-size","background","color","width","text-align","vertical-align","background-color","padding","margin","height","margin-top","margin-left","margin-right","margin-bottom","text-decoration","font-weight","font-style"],wordPasteModal:!0}),b.FE.PLUGINS.wordPaste=function(ad){function ac(){ad.events.on("paste.wordPaste",function(c){return O=c,ad.opts.wordPasteModal?aa():Y(!0),!1})}function ab(){var c='<div class="fr-word-paste-modal" style="padding: 20px 20px 10px 20px;">';return c+='<p style="text-align: left;">'+ad.language.translate("The pasted content is coming from a Microsoft Word document. Do you want to keep the format or clean it up?")+"</p>",c+='<div style="text-align: right; margin-top: 50px;"><button class="fr-remove-word fr-command">'+ad.language.translate("Clean")+'</button> <button class="fr-keep-word fr-command">'+ad.language.translate("Keep")+"</button></div>",c+="</div>"}function aa(){if(!a){var j='<h4><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 74.95 73.23" style="height: 25px; vertical-align: text-bottom; margin-right: 5px; display: inline-block"><defs><style>.a{fill:#2a5699;}.b{fill:#fff;}</style></defs><path class="a" d="M615.15,827.22h5.09V834c9.11.05,18.21-.09,27.32.05a2.93,2.93,0,0,1,3.29,3.25c.14,16.77,0,33.56.09,50.33-.09,1.72.17,3.63-.83,5.15-1.24.89-2.85.78-4.3.84-8.52,0-17,0-25.56,0v6.81h-5.32c-13-2.37-26-4.54-38.94-6.81q0-29.8,0-59.59c13.05-2.28,26.11-4.5,39.17-6.83Z" transform="translate(-575.97 -827.22)"/><path class="b" d="M620.24,836.59h28.1v54.49h-28.1v-6.81h22.14v-3.41H620.24v-4.26h22.14V873.2H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24v-4.26h22.14v-3.41H620.24V846h22.14v-3.41H620.24Zm-26.67,15c1.62-.09,3.24-.16,4.85-.25,1.13,5.75,2.29,11.49,3.52,17.21,1-5.91,2-11.8,3.06-17.7,1.7-.06,3.41-.15,5.1-.26-1.92,8.25-3.61,16.57-5.71,24.77-1.42.74-3.55,0-5.24.09-1.13-5.64-2.45-11.24-3.47-16.9-1,5.5-2.29,10.95-3.43,16.42q-2.45-.13-4.92-.3c-1.41-7.49-3.07-14.93-4.39-22.44l4.38-.18c.88,5.42,1.87,10.82,2.64,16.25,1.2-5.57,2.43-11.14,3.62-16.71Z" transform="translate(-575.97 -827.22)"/></svg> '+ad.language.translate("Word Paste Detected")+"</h4>",i=ab(),h=ad.modals.create(M,j,i),d=h.$body;a=h.$modal,h.$modal.addClass("fr-middle"),ad.events.bindClick(d,"button.fr-remove-word",function(){(a.data("instance")||ad).wordPaste.clean()}),ad.events.bindClick(d,"button.fr-keep-word",function(){(a.data("instance")||ad).wordPaste.clean(!0)}),ad.events.$on(b(ad.o_win),"resize",function(){ad.modals.resize(M)})}ad.modals.show(M),ad.modals.resize(M)}function Z(){ad.modals.hide(M)}function Y(d){var e=ad.opts.wordAllowedStyleProps;d||(ad.opts.wordAllowedStyleProps=[]),O=O.replace(/^\n*/g,"").replace(/^ /g,""),0===O.indexOf("<colgroup>")&&(O="<table>"+O+"</table>"),O=D(O,ad.paste.getRtfClipboard()),O=ad.paste.removeEmptyTags(O),Z(),ad.paste.clean(O,!0,!0),ad.opts.wordAllowedStyleProps=e}function X(c){c.parentNode&&c.parentNode.removeChild(c)}function W(g,f){if(f(g)){for(var j=g.firstChild;j;){var i=j,h=j.previousSibling;j=j.nextSibling,W(i,f),i.previousSibling||i.nextSibling||i.parentNode||!j||h==j.previousSibling||!j.parentNode?i.previousSibling||i.nextSibling||i.parentNode||!j||j.previousSibling||j.nextSibling||j.parentNode||(h?j=h.nextSibling?h.nextSibling.nextSibling:null:g.firstChild&&(j=g.firstChild.nextSibling)):j=h?h.nextSibling:g.firstChild}}}function V(d){if(!d.getAttribute("style")||!/mso-list:[\s]*l/gi.test(d.getAttribute("style").replace(/\n/gi,""))){return !1}try{if(!d.querySelector('[style="mso-list:Ignore"]')){return !1}}catch(c){return !1}return !0}function U(c){return c.getAttribute("style").replace(/\n/gi,"").replace(/.*level([0-9]+?).*/gi,"$1")}function T(g,f){var j=g.cloneNode(!0);if(j.firstElementChild&&"A"==j.firstElementChild.tagName&&(j=j.firstElementChild),-1!=["H1","H2","H3","H4","H5","H6"].indexOf(g.tagName)){var i=document.createElement(g.tagName.toLowerCase());i.setAttribute("style",g.getAttribute("style")),i.innerHTML=j.innerHTML,j.innerHTML=i.outerHTML}W(j,function(c){return c.nodeType==Node.ELEMENT_NODE&&("mso-list:Ignore"==c.getAttribute("style")&&c.parentNode.removeChild(c),G(c,f)),!0});var h=j.innerHTML;return h=h.replace(/<!--[\s\S]*?-->/gi,"")}function S(z,y){var x=/[0-9a-zA-Z]./gi,w=!1;z.firstElementChild&&z.firstElementChild.firstElementChild&&z.firstElementChild.firstElementChild.firstChild&&!(w=w||x.test(z.firstElementChild.firstElementChild.firstChild.data||""))&&z.firstElementChild.firstElementChild.firstElementChild&&z.firstElementChild.firstElementChild.firstElementChild.firstChild&&(w=w||x.test(z.firstElementChild.firstElementChild.firstElementChild.firstChild.data||""));var v=w?"ol":"ul",u=U(z),t="<"+v+"><li>"+T(z,y),s=z.nextElementSibling,m=z.parentNode;for(X(z),z=null;s&&V(s);){var l=s.previousElementSibling,k=U(s);if(k>u){t+=S(s,y).outerHTML}else{if(k<u){break}t+="</li><li>"+T(s,y)}if(u=k,s.previousElementSibling||s.nextElementSibling||s.parentNode){var j=s;s=s.nextElementSibling,X(j),j=null}else{s=l?l.nextElementSibling:m.firstElementChild}}t+="</li></"+v+">";var h=document.createElement("div");return h.innerHTML=t,h.firstElementChild}function R(g,f){for(var j=document.createElement(f),i=0;i<g.attributes.length;i++){var h=g.attributes[i].name;j.setAttribute(h,g.getAttribute(h))}return j.innerHTML=g.innerHTML,g.parentNode.replaceChild(j,g),j}function Q(au,at){ad.node.clearAttributes(au);for(var ar=au.firstElementChild,aq=0,ap=!1,ao=null;ar;){ar.firstElementChild&&-1!=ar.firstElementChild.tagName.indexOf("W:")&&(ar.innerHTML=ar.firstElementChild.innerHTML),ao=ar.getAttribute("width"),ao||ap||(ap=!0),aq+=parseInt(ao,10),(!ar.firstChild||ar.firstChild&&ar.firstChild.data==b.FE.UNICODE_NBSP)&&(ar.firstChild&&X(ar.firstChild),ar.innerHTML="<br>");for(var an=ar.firstElementChild,am=1==ar.children.length;an;){if("P"==an.tagName&&!V(an)){var al=null;1==an.children.length&&an.firstElementChild&&"SPAN"==an.firstElementChild.tagName?'<span lang="EN-US">'===ad.node.openTagString(an.firstElementChild)?an.firstElementChild.outerHTML=an.firstElementChild.innerHTML:(al=an.firstElementChild,am||(al=R(al,"div")),am?L(ar,an.getAttribute("style")):L(al,an.getAttribute("style")),ar.replaceChild(al,an)):(al=R(an,am?"span":"div"),!am&&al.getAttribute("align")&&al.removeAttribute("align")),al&&(an=al),am&&P(an)}an=an.nextElementSibling}if(at){var ak=ar.getAttribute("class");if(ak){ak=N(ak);var ag=ak.match(/xl[0-9]+/gi);if(ag){var ae=ag[0],r="."+ae;at[r]&&L(ar,at[r])}}at.td&&L(ar,at.td)}var q=ar.getAttribute("style");q&&(q=N(q))&&";"!=q.slice(-1)&&(q+=";");var p=ar.getAttribute("valign");if(!p&&q){var n=q.match(/vertical-align:.+?[; "]{1,1}/gi);n&&(p=n[n.length-1].replace(/vertical-align:(.+?)[; "]{1,1}/gi,"$1"))}var j=null;if(q){var h=q.match(/text-align:.+?[; "]{1,1}/gi);h&&(j=h[h.length-1].replace(/text-align:(.+?)[; "]{1,1}/gi,"$1")),"general"==j&&(j=null)}var aj=null;if(q){var ai=q.match(/background:.+?[; "]{1,1}/gi);ai&&(aj=ai[ai.length-1].replace(/background:(.+?)[; "]{1,1}/gi,"$1"))}var ah=ar.getAttribute("colspan"),af=ar.getAttribute("rowspan");ah&&ar.setAttribute("colspan",ah),af&&ar.setAttribute("rowspan",af),p&&(ar.style["vertical-align"]=p),j&&(ar.style["text-align"]=j),aj&&(ar.style["background-color"]=aj),ao&&ar.setAttribute("width",ao),ar=ar.nextElementSibling}for(ar=au.firstElementChild;ar;){ao=ar.getAttribute("width"),ap?ar.removeAttribute("width"):ar.setAttribute("width",100*parseInt(ao,10)/aq+"%"),ar=ar.nextElementSibling}}function P(e){var d=e.parentNode,f=e.getAttribute("align");f&&(d&&"TD"==d.tagName?(d.setAttribute("style",d.getAttribute("style")+"text-align:"+f+";"),e.removeAttribute("align")):(e.style["text-align"]=f,e.removeAttribute("align")))}function N(c){return c.replace(/\n|\r|\n\r|&quot;/g,"")}function L(g,f,j){if(f){var i=g.getAttribute("style");i&&";"!=i.slice(-1)&&(i+=";"),f&&";"!=f.slice(-1)&&(f+=";"),f=f.replace(/\n/gi,"");var h=null;h=j?(i||"")+f:f+(i||""),g.setAttribute("style",h)}}function J(v){var u=v.getAttribute("style");if(u){u=N(u),u&&";"!=u.slice(-1)&&(u+=";");var t=u.match(/(^|\S+?):.+?;{1,1}/gi);if(t){for(var s={},r=0;r<t.length;r++){var q=t[r],p=q.split(":");2==p.length&&("text-align"==p[0]&&"SPAN"==v.tagName||(s[p[0]]=p[1]))}var o="";for(var n in s){if(s.hasOwnProperty(n)){if("font-size"==n&&"pt;"==s[n].slice(-3)){var m=null;try{m=parseFloat(s[n].slice(0,-3),10)}catch(l){}m&&(m=Math.round(1.33*m),s[n]=m+"px;")}o+=n+":"+s[n]}}o&&v.setAttribute("style",o)}}}function I(g){for(var f=g.match(/[0-9a-f]{2}/gi),j=[],i=0;i<f.length;i++){j.push(String.fromCharCode(parseInt(f[i],16)))}var h=j.join("");return btoa(h)}function H(A,z){if(z){var y;if("IMG"==A.tagName){var x=A.getAttribute("src");if(!x||-1==x.indexOf("file://")){return}y=K[A.getAttribute("v:shapes")]}else{y=A.parentNode.getAttribute("o:spid")}if(y){var w="hplid"+y.substring(8),v=z.split(w);if(!v||2==v.length){var u=v[1].split("bliptag");if(!(u&&u.length<2)){var t=null;if(-1!=u[0].indexOf("pngblip")?t="image/png":-1!=u[0].indexOf("jpegblip")&&(t="image/jpeg"),t){var s=u[1].split("}");if(!(s&&s.length<2)){var r;if(s.length>2&&-1!=s[0].indexOf("blipuid")){r=s[1].split(" ")}else{if((r=s[0].split(" "))&&r.length<2){return}r.shift()}var q=r.join(""),p=I(q),o="data:"+t+";base64,"+p;"IMG"===A.tagName?(A.src=o,A.setAttribute("data-fr-image-pasted",!0)):b(A.parentNode).before('<img data-fr-image-pasted="true" src="'+o+'" style="'+A.parentNode.getAttribute("style")+'">').remove()}}}}}}}function G(C,B){var A=C.tagName,z=A.toLowerCase();if(C.firstElementChild&&("I"==C.firstElementChild.tagName?R(C.firstElementChild,"em"):"B"==C.firstElementChild.tagName&&R(C.firstElementChild,"strong")),-1!=["SCRIPT","APPLET","EMBED","NOFRAMES","NOSCRIPT"].indexOf(A)){return X(C),!1}"O:P"==A&&"&nbsp;"==C.innerHTML&&(C.innerHTML=b.FE.INVISIBLE_SPACE);var y=-1,r=["META","LINK","XML","ST1:","O:","W:","FONT"];for(y=0;y<r.length;y++){if(-1!=A.indexOf(r[y])){return C.innerHTML?(C.outerHTML=C.innerHTML,X(C),!1):(X(C),!1)}}if("TD"!=A){var q=C.getAttribute("class");if(B&&q){q=N(q);var p=q.split(" ");for(y=0;y<p.length;y++){var o=p[y],n=[],h="."+o;n.push(h),h=z+h,n.push(h);for(var aj=0;aj<n.length;aj++){B[n[aj]]&&L(C,B[n[aj]])}}}B&&B[z]&&L(C,B[z])}if(-1!=["P","H1","H2","H3","H4","H5","H6","PRE"].indexOf(A)){var ai=C.getAttribute("class");if(ai&&(B&&B[A.toLowerCase()+"."+ai]&&L(C,B[A.toLowerCase()+"."+ai]),-1!=ai.toLowerCase().indexOf("mso"))){var ah=N(ai);ah=ah.replace(/[0-9a-z-_]*mso[0-9a-z-_]*/gi,""),ah?C.setAttribute("class",ah):C.removeAttribute("class")}var ag=C.getAttribute("style");if(ag){var af=ag.match(/text-align:.+?[; "]{1,1}/gi);af&&af[af.length-1].replace(/(text-align:.+?[; "]{1,1})/gi,"$1")}P(C)}if("TR"==A&&Q(C,B),"A"==A&&!C.attributes.getNamedItem("href")&&C.innerHTML&&(C.outerHTML=C.innerHTML),"TD"!=A&&"TH"!=A||C.innerHTML||(C.innerHTML="<br>"),"TABLE"==A&&(C.style.width="100%"),C.getAttribute("lang")&&C.removeAttribute("lang"),C.getAttribute("style")&&-1!=C.getAttribute("style").toLowerCase().indexOf("mso")){var ae=N(C.getAttribute("style"));ae=ae.replace(/[0-9a-z-_]*mso[0-9a-z-_]*:.+?(;{1,1}|$)/gi,""),ae?C.setAttribute("style",ae):C.removeAttribute("style")}return !0}function F(v){var u={},t=v.getElementsByTagName("style");if(t.length){var s=t[0],r=s.innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi);if(r){for(var q=0;q<r.length;q++){var p=r[q],o=p.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),n=p.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");o=o.replace(/^[\s]|[\s]$/gm,""),n=n.replace(/^[\s]|[\s]$/gm,""),o=o.replace(/\n|\r|\n\r/g,""),n=n.replace(/\n|\r|\n\r/g,"");for(var m=o.split(", "),l=0;l<m.length;l++){u[m[l]]=n}}}}return u}function E(h){for(var g=h.split("v:shape"),l=1;l<g.length;l++){var k=g[l],j=k.split(' id="')[1];if(j&&j.length>1){j=j.split('"')[0];var i=k.split(' o:spid="')[1];i&&i.length>1&&(i=i.split('"')[0],K[j]=i)}}}function D(t,s){t=t.replace(/[.\s\S\w\W<>]*(<html[^>]*>[.\s\S\w\W<>]*<\/html>)[.\s\S\w\W<>]*/gi,"$1"),E(t);var r=new DOMParser,q=r.parseFromString(t,"text/html"),p=q.head,m=q.body,j=F(p);W(m,function(c){if(c.nodeType==Node.TEXT_NODE&&/\n|\u00a0/.test(c.data)){if(!/\S/.test(c.data)){return c.data==b.FE.UNICODE_NBSP?(c.data="\u200b",!0):(X(c),!1)}c.data=c.data.replace(/\n/gi," ")}return !0}),W(m,function(c){return c.nodeType!=Node.ELEMENT_NODE||"V:IMAGEDATA"!=c.tagName&&"IMG"!=c.tagName||H(c,s),!0}),W(m,function(g){if(g.nodeType==Node.TEXT_NODE){return g.data=g.data.replace(/<br>(\n|\r)/gi,"<br>"),!1}if(g.nodeType==Node.ELEMENT_NODE){if(V(g)){var f=g.parentNode,n=g.previousSibling,l=S(g,j),k=null;return k=n?n.nextSibling:f.firstChild,k?f.insertBefore(l,k):f.appendChild(l),!1}return G(g,j)}return g.nodeType!=Node.COMMENT_NODE||(X(g),!1)}),W(m,function(e){if(e.nodeType==Node.ELEMENT_NODE){var d=e.tagName;if(!e.innerHTML&&-1==["BR","IMG"].indexOf(d)){for(var f=e.parentNode;f&&(X(e),e=f,!e.innerHTML);){f=e.parentNode}return !1}J(e)}return !0});var i=m.outerHTML,h=ad.opts.htmlAllowedStyleProps;return ad.opts.htmlAllowedStyleProps=ad.opts.wordAllowedStyleProps,i=ad.clean.html(i,ad.opts.wordDeniedTags,ad.opts.wordDeniedAttrs,!1),ad.opts.htmlAllowedStyleProps=h,i}var a,O,M="word_paste",K={};return{_init:ac,clean:Y}}});