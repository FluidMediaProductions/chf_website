$(document).ajaxError(function(h,e,g,f){Raven.captureMessage(f||e.statusText,{level:"error",extra:{type:g.type,url:g.url,data:g.data,status:e.status,error:f||e.statusText,response:e.responseText}});Raven.showReportDialog()});function initGoogleMaps(){var b=$("#property-search").get(0);searchBox=new google.maps.places.SearchBox(b);searchBox.setBounds(new google.maps.LatLngBounds({lng:-3.8776106640625585,lat:51.09789643167155},{lng:-1.9550032421875585,lat:52.12124375625608}));if(typeof initMap==="function"){initMap()}}$(function(){$('a[href*="#"]').not('[href="#"]').not('[href="#0"]').click(function(d){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")&&location.hostname===this.hostname){var c=$(this.hash);c=c.length?c:$("[name="+this.hash.slice(1)+"]");if(c.length){d.preventDefault();$("html, body").animate({scrollTop:c.offset().top},1000,function(){var a=$(c);a.focus();if(a.is(":focus")){return false}else{a.attr("tabindex","-1");a.focus()}})}}});$(".socials").find("a i").hover(function(){var b=$(this);b.data("old-colour",b.css("color"));b.css("color",b.data("colour"))},function(){var b=$(this);b.css("color",b.data("old-colour"))})});function setupMainCarousel(c,d){c.height(Math.max(window.innerHeight-c.offset().top,d));$(window).on("resize",function(){c.height(Math.max(window.innerHeight-c.offset().top,d))});c.find(".carousel-icon i").click(function(){$("html, body").animate({scrollTop:$(this).offset().top},1500)})}function loadFeaturedHouses(d){var c=$('    <div class="col-sm-6 col-lg-3 mt-4">        <div class="card">            <div class="corner-ribbon-container">                <img class="card-img-top" src="" alt="">                <div class="corner-ribbon"><span></span></div>            </div>            <div class="card-body">                <h4 class="card-title"></h4>                <h5 class="card-subtitle mb-2 text-muted"></h5>                <a href="#" class="btn btn-primary">View</a>            </div>        </div>    </div>');$.get({url:"http://148.251.235.232:8001/properties",dataType:"text",success:function(a){var b=a.replace(/\\r/g,"\\\\n");b=JSON.parse(b);if(b.status==="good"){for(var k=0;k<4&&k<b.properties.length;k++){var i=b.properties[k];var j=c.clone();j.find("img").attr("src",i.photos[0]);j.find("h4").text(i.name);j.find("h5").text(i.address);j.find("a").attr("href","/properties/"+i.id);if(i.sold===true){j.find(".corner-ribbon").addClass("sold").find("span").text("Sold STC")}else{j.find(".corner-ribbon span").text("For sale")}j.appendTo(d)}d.find(".loader-box").hide()}else{Raven.captureMessage("Invalid response when getting featured houses",{level:"error",extra:{response:a}});Raven.showReportDialog()}},error:function(){d.html($("<h2>").addClass("text-center").addClass("w-100").text("There was an error communicating with the server. Try again later."))}})}function loadProperty(i,j,g){var l=$(".loader-box");var h;var k=setInterval(function(){if(typeof h==="object"){j.setCenter(h);g.setPosition(h);clearInterval(k)}},500);l.show().parent().css("min-height",window.innerHeight-l.offset().top);$.get({url:"http://148.251.235.232:8001/properties/"+i,dataType:"text",success:function(d){var f=d.replace(/\\r/g,"\\\\n");f=JSON.parse(f);if(f.status==="good"){var b=f.property;var q=$("#houseImageCarousel");$("#description").text(b.desc.replace(/\\n/g,"\n"));$("#house-name").text(b.name);$("#address").text(b.address);$("#floorplan").attr("src",b.floorplan);$("#price").text(b.price);h=b.loc;if(b.sold===true){q.find(".corner-ribbon").addClass("sold").find("span").text("Sold STC")}else{q.find(".corner-ribbon span").text("For sale")}for(var e=0;e<b.features.length;e++){var a=b.features[e];$("#features").append($("<li>").text(a))}for(e=0;e<b.photos.length;e++){var r=b.photos[e];var s=$('<div class="carousel-item"><img class="d-block w-100" src="" alt=""></div>');var c=$('<li data-target="#houseImageCarousel" data-slide-to="'+e+'" ></li>');s.find("img").attr("src",r);q.find(".carousel-inner").append(s);q.find(".carousel-indicators").append(c)}q.find(".carousel-indicators li:first").addClass("active");q.find(".carousel-inner div:first").addClass("active")}else{if(f.status==="error"){if(f.error==="id-not-found"){$(".property-body").show().html($("<h1 class='my-4 text-center'>").text("House not found"));l.hide().parent().css("min-height","0");Raven.captureMessage("House not found",{level:"warning",extra:{houseId:i}});Raven.showReportDialog()}}else{Raven.captureMessage("Invalid response when getting house",{level:"error",extra:{response:d,houseId:i}});Raven.showReportDialog()}}l.hide().parent().css("min-height","0");$(".property-body").show()},error:function(){$(".property-body").show().html($("<h1 class='my-4 text-center'>").text("There was an error communicating with the server. Try again later."));l.hide().parent().css("min-height","0")}})}function doPropertySearch(e){var f=$(".loader-box");f.show().parent().css("min-height",window.innerHeight-f.offset().top);$(".results .house:not(:first)").remove();var d;if(e===""){d="/properties"}else{d="/properties/search/"+encodeURIComponent(e)}$.get({url:"http://148.251.235.232:8001"+d,dataType:"text",success:function(j){var r=j.replace(/\\r/g,"\\\\n");r=JSON.parse(r);if(r.status==="good"){var p=$(".results .house:first");if(r.properties.length===0){if(e!==""){$("#results-header").text("No property results in "+e)}else{$("#results-header").text("No property results")}}else{if(e!==""){$("#results-header").text("Property results in "+e)}for(var q=0;q<r.properties.length;q++){var c=r.properties[q];var a=p.clone();a.find("h3").text(c.name);a.find("h5.card-subtitle").text(c.address);a.find("h4").text(c.price);if(e!==""){var i=Math.round(c.distance*10)/10;a.find("h5:not(:first)").text(i+" miles from search location")}for(var s=0;s<c.features.length;s++){var b=c.features[s];a.find("ul").append($("<li>").text(b))}a.find("img").eq(0).attr("src",c.photos[0]);a.find("img").eq(1).attr("src",c.photos[1]);if(c.sold===false){a.find(".corner-ribbon span").text("For sale")}else{a.find(".corner-ribbon").addClass("sold").find("span").text("Sold STC")}a.data("house-id",c.id);a.show();a.appendTo(".results > div.container")}}}else{if(r.status==="error"){if(r.error==="loc-not-found"){$("#results-header").text(e+" could not be found");Raven.captureMessage("Location could not be found",{level:"info",extra:{location:e}})}}else{Raven.captureMessage("Invalid response when getting featured houses",{level:"error",extra:{response:j}});Raven.showReportDialog()}}f.hide().parent().css("min-height","0")},error:function(){$("#results-header").text("There was an error communicating with the server. Try again later.");f.hide().parent().css("min-height","0")}})};